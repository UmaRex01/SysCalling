# Vectored Syscall

## Stuff you should know

A **hardware breakpoint** (also known as a processor breakpoint or data breakpoint) is a mechanism that allows the processor to interrupt the execution of a programme when a specific event occurs. Unlike software breakpoints, which are handled directly by a debugger and modify the code by inserting interrupt instructions, hardware breakpoints use the processor's debug registers without modifying the code.

There are four types of hardware breakpoints, corresponding to the type of memory access being performed:
- Execute: is triggered when an instruction is executed at the specified address;
- Read: is triggered when the memory at the monitored address is read;
- Write: turns ON when memory at the specified address is being written;
- I/O Access: turns ON when an I/O operation is performed on a specified port.

Hardware breakpoints are implemented using registers specifically provided by the processor for debugging operations. Specifically, registers `DR0` to `DR3` are used to specify the memory address at which the breakpoint is to be set, while register `DR7` is used to specify its type.

## Vectored Syscall
TODO

## Implementation
TODO

## Focus on Call Stack
TODO

## Test Result
The shellcode was successfully executed, and no notifications were generated by the antivirus software.

<p align="center">
  <img width="460" src="https://github.com/user-attachments/assets/c95395c0-bb32-4e31-81fc-f38551ff1651">
</p>

## RELATED PROJECTS

[MutationGate](https://github.com/senzee1984/MutationGate) by @senzee1984\
[HWSyscalls](https://github.com/Dec0ne/HWSyscalls) by Dec0ne\
[TamperingSyscalls](https://github.com/rad9800/TamperingSyscalls) by rad9800\
[VEH-PoC](https://github.com/RedTeamOperations/VEH-PoC) by RedTeamOperations

## REFERENCES

[https://cyberwarfare.live/bypassing-av-edr-hooks-via-vectored-syscall-poc/](https://cyberwarfare.live/bypassing-av-edr-hooks-via-vectored-syscall-poc/)\
[https://redops.at/en/blog/syscalls-via-vectored-exception-handling](https://redops.at/en/blog/syscalls-via-vectored-exception-handling)\
[https://winslow1984.com/books/malware/page/mutationgate](https://winslow1984.com/books/malware/page/mutationgate)\
[https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/processor-breakpoints---ba-breakpoints-](https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/processor-breakpoints---ba-breakpoints-)
